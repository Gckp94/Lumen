# Risk Profile: Story 1.2 - Themed Application Shell

Date: 2026-01-09
Reviewer: Quinn (Test Architect)

## Executive Summary

- **Total Risks Identified:** 7
- **Critical Risks:** 0
- **High Risks:** 0
- **Medium Risks:** 1
- **Risk Score:** 86/100 (Low risk)

This is a **low-risk UI story** focused on theming and visual scaffolding. The primary risks relate to font loading reliability and QSS stylesheet correctness. No security or data risks identified due to the purely visual nature of this story.

## Risk Matrix

| Risk ID | Description | Probability | Impact | Score | Priority |
|---------|-------------|-------------|--------|-------|----------|
| TECH-002 | QSS stylesheet parsing errors across platforms | Medium (2) | Medium (2) | 4 | Medium |
| TECH-001 | Custom font loading failure | Medium (2) | Low (1) | 2 | Low |
| TECH-003 | PyQt6 version QSS compatibility | Low (1) | Medium (2) | 2 | Low |
| OPS-001 | Font files missing from deployment | Medium (2) | Low (1) | 2 | Low |
| BUS-001 | Color contrast accessibility (WCAG) | Low (1) | Medium (2) | 2 | Low |
| OPS-002 | Theme module coupling issues | Low (1) | Low (1) | 1 | Minimal |
| PERF-001 | Startup delay from font loading | Low (1) | Low (1) | 1 | Minimal |

## Detailed Risk Analysis

### TECH-002: QSS Stylesheet Parsing Errors (Score: 4 - Medium)

**Description:** The Observatory theme requires a comprehensive QSS stylesheet with styling for QMainWindow, QTabWidget, QTabBar, scrollbars, and common widgets. Complex stylesheets may have syntax errors or behave inconsistently across platforms (Windows/macOS/Linux).

**Probability:** Medium (2) - QSS syntax is strict and error-prone; platform differences exist
**Impact:** Medium (2) - Incorrect styles degrade user experience but don't break functionality

**Affected Components:**
- `src/ui/theme.py` - `get_stylesheet()` function
- All QWidget-derived classes

**Mitigation:**
| Strategy | Action | Owner |
|----------|--------|-------|
| Preventive | Test stylesheet on Windows (primary target) during development | Dev |
| Detective | Add logging for stylesheet loading errors | Dev |
| Corrective | Implement fallback to minimal stylesheet on error | Dev |

**Testing Requirements:**
- Unit test: Verify stylesheet is non-empty and contains expected color values
- Widget test: Verify styled widgets render without errors
- Manual: Visual inspection on target platform

**Residual Risk:** Low - With proper testing, stylesheet issues are caught early

---

### TECH-001: Font Loading Failure (Score: 2 - Low)

**Description:** Custom fonts (Azeret Mono, Geist) must be loaded from `assets/fonts/` using `QFontDatabase.addApplicationFont()`. Fonts may fail to load due to missing files, incorrect paths, or incompatible font formats.

**Probability:** Medium (2) - Font files must be manually obtained and placed correctly
**Impact:** Low (1) - Application falls back to system fonts; cosmetic issue only

**Affected Components:**
- `src/ui/theme.py` - `load_fonts()` function
- `assets/fonts/` directory

**Mitigation:**
| Strategy | Action | Owner |
|----------|--------|-------|
| Preventive | Document font download instructions in Dev Notes | Dev |
| Detective | Log font loading success/failure per file | Dev |
| Corrective | Graceful fallback to system defaults when fonts unavailable | Dev |

**Testing Requirements:**
- Unit test: `load_fonts()` returns bool indicating success
- Manual: Verify fonts render correctly when loaded

**Residual Risk:** Minimal - Fallback ensures application functions without custom fonts

---

### TECH-003: PyQt6 Version Compatibility (Score: 2 - Low)

**Description:** QSS behavior may differ across PyQt6 versions. Some selectors or properties may not work as expected in different versions.

**Probability:** Low (1) - PyQt6 QSS is relatively stable
**Impact:** Medium (2) - Could cause visual inconsistencies

**Mitigation:**
| Strategy | Action | Owner |
|----------|--------|-------|
| Preventive | Pin PyQt6 version in pyproject.toml | Dev |
| Detective | Document tested PyQt6 version in Dev Notes | Dev |

**Residual Risk:** Minimal - Version pinning prevents unexpected changes

---

### OPS-001: Font Files Missing from Deployment (Score: 2 - Low)

**Description:** Font files in `assets/fonts/` may not be included when packaging or deploying the application.

**Probability:** Medium (2) - Asset inclusion requires explicit configuration
**Impact:** Low (1) - Falls back to system fonts

**Mitigation:**
| Strategy | Action | Owner |
|----------|--------|-------|
| Preventive | Include assets/ in pyproject.toml package data | Dev |
| Detective | Add deployment checklist item for font verification | Ops |

**Residual Risk:** Minimal - With proper packaging, fonts are included

---

### BUS-001: Color Contrast Accessibility (Score: 2 - Low)

**Description:** The Observatory color palette (TEXT_PRIMARY #F4F4F8 on BG_BASE #0C0C12) should meet WCAG accessibility guidelines, but TEXT_DISABLED (#5C5C6C) on dark backgrounds may have insufficient contrast.

**Probability:** Low (1) - Primary colors appear to have good contrast
**Impact:** Medium (2) - Accessibility issues could affect some users

**Mitigation:**
| Strategy | Action | Owner |
|----------|--------|-------|
| Detective | Test color contrast ratios with accessibility tools | QA |
| Corrective | Adjust TEXT_DISABLED if contrast is insufficient | Design |

**Residual Risk:** Low - Primary text colors have good contrast; disabled text is intentionally dimmed

---

### OPS-002: Theme Module Coupling (Score: 1 - Minimal)

**Description:** If theme.py is tightly coupled to specific widget classes, future theming changes may require extensive refactoring.

**Probability:** Low (1) - Story explicitly requires reusable theme module
**Impact:** Low (1) - Technical debt, not user-facing

**Mitigation:**
| Strategy | Action | Owner |
|----------|--------|-------|
| Preventive | Follow AC 10: Theme loading extracted to `src/ui/theme.py` for reuse | Dev |

**Residual Risk:** Minimal

---

### PERF-001: Startup Delay from Font Loading (Score: 1 - Minimal)

**Description:** Loading 7 font files at startup may add slight delay to application launch.

**Probability:** Low (1) - Font loading is typically fast
**Impact:** Low (1) - Sub-second delay is acceptable

**Mitigation:**
| Strategy | Action | Owner |
|----------|--------|-------|
| Detective | Profile startup time if perceived as slow | Dev |

**Residual Risk:** Minimal - Unlikely to be noticeable

---

## Risk Distribution

### By Category
- **Technical:** 3 risks (1 medium)
- **Operational:** 2 risks (0 medium)
- **Business:** 1 risk (0 medium)
- **Performance:** 1 risk (0 medium)
- **Security:** 0 risks
- **Data:** 0 risks

### By Component
- **src/ui/theme.py:** 3 risks (TECH-001, TECH-002, OPS-002)
- **assets/fonts/:** 2 risks (TECH-001, OPS-001)
- **QSS Stylesheet:** 2 risks (TECH-002, TECH-003)
- **Color Constants:** 1 risk (BUS-001)

## Risk-Based Testing Strategy

### Priority 1: Medium Risk Tests
- **TECH-002:** Validate QSS stylesheet loads without errors
- **TECH-002:** Verify styled widgets render correctly

### Priority 2: Low Risk Tests
- **TECH-001:** Test font loading function returns appropriate status
- **OPS-001:** Verify font files are accessible from expected path

### Priority 3: Minimal Risk Tests
- **PERF-001:** Only test if startup performance is observed as slow

## Risk Acceptance Criteria

### Must Fix Before Production
- None - no critical or high risks identified

### Can Deploy with Mitigation
- All identified risks have acceptable mitigations in place

### Accepted Risks
- **TEXT_DISABLED contrast:** Intentionally lower contrast for disabled state; acceptable per design spec

## Monitoring Requirements

Post-deployment monitoring:
- Log font loading success/failure at startup
- No specific performance metrics needed for this low-risk story

## Risk Review Triggers

Review and update risk profile when:
- Adding new theme variants
- Supporting additional platforms
- Changing font stack
- Receiving accessibility feedback

---

## Gate YAML Block

```yaml
# risk_summary (paste into gate file):
risk_summary:
  totals:
    critical: 0
    high: 0
    medium: 1
    low: 4
  highest:
    id: TECH-002
    score: 4
    title: 'QSS stylesheet parsing errors across platforms'
  recommendations:
    must_fix: []
    monitor:
      - 'Log font loading success/failure at startup'
```

---

Risk profile: docs/qa/assessments/1.2-risk-20260109.md
